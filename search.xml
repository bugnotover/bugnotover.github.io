<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Ansible的安装与使用</title>
      <link href="/posts/undefined.html"/>
      <url>/posts/undefined.html</url>
      
        <content type="html"><![CDATA[<p>欢迎访问我的<a href="https://yuanjibin.cn/">博客</a>，有相同需求的小伙伴我们一起学习，共同进步。</p><h2 id="Ansible安装与使用"><a href="#Ansible安装与使用" class="headerlink" title="Ansible安装与使用"></a>Ansible安装与使用</h2><p>   首先，物理机需要配置python环境，我已经安装好了python3.8，搭建配置好两台虚拟机，确保设备正常运转。</p><h3 id="Ansible简介"><a href="#Ansible简介" class="headerlink" title="Ansible简介"></a>Ansible简介</h3><p>“Ansible is Simple IT Automation”——简单的自动化IT工具。Ansible是一款简单的运维自动化工具，只需要使用ssh协议连接就可以来进行系统管理，自动化执行命令，部署等任务。</p><h3 id="安装ansible"><a href="#安装ansible" class="headerlink" title="安装ansible"></a>安装ansible</h3><p>####直接安装</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ yum install epel-release</span><br><span class="line">$ yum install ansible</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p><img src="/source/media/1.png" alt="avatar"></p><p>在安装ansible报错<br>Cannot retrieve metalink for repository:epel.Please verify its path and try again.<br>可以修改epel.repo文件解决问题。</p><p><img src="/source/media/2.png" alt="avatar"><br>而后继续安装ansible。</p><p><img src="/source/media/3.png" alt="avatar"></p><p>####验证是否成功</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ansible --version</span><br><span class="line">ansible 2.6.20</span><br></pre></td></tr></tbody></table></figure><p>安装成功</p><p><img src="/source/media/4.png" alt="avatar"></p><h3 id="配置ansible"><a href="#配置ansible" class="headerlink" title="配置ansible"></a>配置ansible</h3><p>控制主机：用于控制其它机器的主机<br>管理主机：被控制主机管理的主机</p><h4 id="配置管理主机，输入"><a href="#配置管理主机，输入" class="headerlink" title="配置管理主机，输入"></a>配置管理主机，输入</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ansible/host</span><br></pre></td></tr></tbody></table></figure><p>在hosts文件中添加管理主机的IP地址列表，可在管理主机中输入ifconfig查看ip</p><p><img src="/source/media/5.png" alt="avatar"></p><h4 id="配置控制主机SSH密钥"><a href="#配置控制主机SSH密钥" class="headerlink" title="配置控制主机SSH密钥"></a>配置控制主机SSH密钥</h4><p>在控制主机中生成ssh密钥对，输入命令ssh-keygen -t rsa<br>一路回车即可在$HOME/.ssh目录下生成id_rsa和id_rsa.put私钥和公钥两个文件。</p><p><img src="/source/media/6.png" alt="avatar"></p><h4 id="将公钥拷贝到管理主机中-ssh-authorized-keys文件中，实现免密码登录远程管理主机"><a href="#将公钥拷贝到管理主机中-ssh-authorized-keys文件中，实现免密码登录远程管理主机" class="headerlink" title="将公钥拷贝到管理主机中.ssh/authorized_keys文件中，实现免密码登录远程管理主机"></a>将公钥拷贝到管理主机中.ssh/authorized_keys文件中，实现免密码登录远程管理主机</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-copy-id -i ~/.ssh/id_rsa.pub root@192.168.124.130</span><br><span class="line">$ ssh-copy-id -i ~/.ssh/id_rsa.pub root@192.168.124.131</span><br><span class="line">$ ssh-copy-id -i ~/.ssh/id_rsa.pub root@49.234.215.176</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p><img src="/source/media/7.png" alt="avatar"><br><img src="/source/media/8.png" alt="avatar"></p><h4 id="ansible设置"><a href="#ansible设置" class="headerlink" title="ansible设置"></a>ansible设置</h4><p>（1） 禁用每次执行ansbile命令检查ssh key host<br>host_key_checking = False<br>（2）开启日志记录<br>log_path = /var/log/ansible.log<br>（3） ansible连接加速配置<br><img src="/source/media/9.png" alt="avatar"></p><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>最后测试下在三台管理机器批量执行一个ping命令</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m ping</span><br></pre></td></tr></tbody></table></figure><p><img src="/source/media/10.png" alt="avatar"></p><p>可以看出，ansible已经部署成功了！！！</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
